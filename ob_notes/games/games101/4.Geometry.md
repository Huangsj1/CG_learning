# 一、几何的表达方式

## 1. 隐式几何表示

满足某些**特定关系** `f(x, y, z) = 0` 的几何（如：x^2 + y^2 + z^2 = 1）

* 缺点：很难看出隐式几何表示的是什么**形状**
* 优点：容易判断点的**位置**关系（f > 0 -> 几何外）

### 1. 代数表示

![[Pasted image 20230610214555.png]]

### 2. CSG（Constructive Solid Geometry）构造实体几何

通过**布尔运算**将隐式几何结合起来

![[Pasted image 20230610214825.png]]

### 3. 距离函数

对于任意一个几何，不直接描述其表面，而是描述**空间中任意一个点到这个表面的距离**，这样通过空间中的所有点得到所有距离的距离函数，就可以通过blending达到融合效果

下图中最开始得到所有点到物体表面的**距离函数**，通过blend（混合）之后得到**总的距离函数**，再恢复得到表面（SDF为0）

![[Pasted image 20230610220013.png]]

下图中A被遮挡了1/3，B被遮挡了2/3，-的部分表示被遮挡的，0表示表面边界，+表示未被遮挡的，将A和B地**距离函数加和**得到最终的距离函数，**0就代表表面**

![[Pasted image 20230610220006.png]]

#### 水平集（运用SDF找到表面）

![[Pasted image 20230610220747.png]]

### 4. 分形几何 Fractals

**自相似**（递归）

![[Pasted image 20230610221006.png]]

## 2. 显示几何表示

直接给出**所有点** 或者 通过**参数映射**（将所有点直接得到映射后的点，如 `f(u, v) = (cosu, sinv, sinu)`）

* 缺点：难以判断点的位置关系
* 优点：容易看出几何形状

### 1. 点云

用空间中的**一堆点**的集合来表示物体。只要点足够密集，就看不到点与点之间的间隙

### 2. 多边形面

用三角形等多边形描述三维几何（最广泛应用）

# 二、曲线 Curve

## 1. 贝塞尔曲线（显示几何表示）

### 1. 二次贝塞尔曲线

1. 选取三个点
2. 在相邻两点的线段上找出对应 **t 比例** 的点，并将相邻的找出的点连起来
3. 再在找到的两个点的线段上同样找出对应 **t 比例** 的点，这个点就是在t时刻/比例下贝塞尔曲线上的点
4. 不断**重复t**在\[ 0, 1 ]之间取值得到曲线

![[Pasted image 20230611171016.png|400]]

三次/多次贝塞尔曲线都是同样的做法

![[Pasted image 20230611171051.png]]

### 2. 贝塞尔曲线的代数表示

贝塞尔曲线上的点可以跟时间t联系起来

![[8a080237be2df05b2cba393014313bb.jpg|400]]

线段上的点可以用首尾两个点表示

![[6d841ea1ef726290f96c0ae08f8a86c.jpg|400]]

所有点的线性组合的系数就是**多项式系数**

![[11f09fec1285723fcbbd4c3bf4c5ce8.jpg]]

三维空间下三次的贝塞尔曲线

![[Pasted image 20230611172307.png|400]]

### 3. 贝塞尔曲线的性质

1. Interpolates endpoints：一定**过起点和终点**
	* 对于三次：b(0) = b0；b(1) = b3
2. Tangent to end segments：曲线起始和终止的**切线方向**都从线段起点到线段终点
	* 对于三次：b'(0) = 3(b1 - b0)；b'(1) = 3(b3 - b2)（对b(t)求导然后带入t=0和t=1即可得到结果）
3. Affine transformation property：对控制点做**仿射变换**后再得到贝塞尔曲线和对原贝塞尔曲线上的点做仿射变换得到的曲线一样
4. 凸包性质：贝塞尔曲线会在所有控制点形成的**凸包内**

### 4. 逐段贝塞尔曲线

控制点多了的时候贝塞尔曲线并不直观，很难控制；于是习惯每次用**4个控制点定义一段贝塞尔曲线**，再将他们**连起来**

![[Pasted image 20230611174411.png|400]]

#### 连续性

* C0连续/位置连续（点相同）：前一段贝塞尔曲线的终点和后一段贝塞尔曲线的起**点一致**
* C1连续（切线相同）：前后两端线段的**斜率相同**且**模长相同**（如果两段线段距离不同就不是C1连续，只是普通斜率连续）

![[Pasted image 20230611175036.png]]

## 2. 样条曲线 Spline

**样条**：连续的曲线，由**一系列控制点控制**，满足一定的连续性，也就是可控的曲线

**B样条曲线**：贝塞尔曲线的扩展，对不同的控制点做加权平均，具有**局部性**（改变一个控制点只会影响到局部）

# 四、曲面

## 贝塞尔曲面

u方向画出四条贝塞尔曲线，然后在v方向上取对应四条贝塞尔曲线的四个点当作控制点，继续进行v方向上的贝塞尔曲线，将v方向上的贝塞尔曲线扫描一遍就形成了贝塞尔曲面

![[41dae0a78bd082df298eddcdf1c8014.jpg|300]] ![[d5e131d807f9a359355a85737466e4c.jpg|300]]

根据（u，v）（uv分别代表u方向上和v方向上的时间）计算出贝塞尔曲面上的一个点的位置

1. 根据u找到v方向上的四个点的位置，并且可以得到v方向上的贝塞尔曲线
2. 再根据v得到v方向上的贝塞尔曲线的对应点

![[a9866e5b19b51dd083cdf53b9410816.jpg|500]]

# 五、几何处理

## 1. 曲面细分 Mesh Subdivision

> 将平面分成更多平面，包括**细分**（分成更多面）和**调整**（调整面的点值/高度）

### 1. Loop Subdivision

将三角形细分和调整得到**更光滑**的图形（只适用于三角形）

#### 1. 细分

* 连接三角形各边中点，创建更多三角形

![[Pasted image 20230611194055.png|400]]

#### 2. 调整

* 对于新顶点，其值由老顶点决定（不同的权重，左下图）
* 对于老顶点，其值由其他老顶点和自己的值更新（不同权重，右下图，其中n为顶点的度，u为权重）

![[Pasted image 20230611194601.png]]

### 2. Catmull-Clark（General Mesh）

#### 1. 细分

1. 对于每个面都取中点
2. 对于面上的边都取中点
3. 将面的中点与边上的中点连起来，就可以形成更多的面

* Non-quad face：非四边的面
* Extraordinary vertex：奇异点，度数 != 4的点

![[Pasted image 20230611195823.png|400]]

对于每个非四边行的面经过细分后中间都会**多出一个奇异点**，而且该**非四边行的面消失**，里面全部分成四边形

所以经过一次细分后，所有的**非四边行的面都消失**，多出了原本非四边行面个数的奇异点（之后奇异点不会增加）

![[dfe004cc8edce292d40a97bb2f632ec.jpg|300]] ![[11b81210d184e01b977cca10c273f3c.jpg|300]]

#### 2. 调整

* 新的点：包括**面中心**的点 和 **边中间**的点
* 旧的点：用周围面中心点、边中心点和自己的值更新

![[Pasted image 20230611200844.png]]

![[8f8931ae032ca896e02f0738f28cb7b.jpg]]

## 2. 曲面简化 Mesh Simplification

> 减少平面数量

![[c302351a913ea737fd3a54d8652a820.jpg|500]]

### Collapsing An Edge 边坍缩

Quadric Error of Edge Collapse **二次误差度量**：坍缩后的点和原本几个点/边/面的**距离平方和最小**

![[Pasted image 20230611203325.png]]

对每一条边都先计算二次误差，从**小到大**排序并依次坍缩

问题：做了一次坍缩后，其他边也跟着改变，他们的二次误差就需要重新计算

解决方案：所以需要每次**取误差最小**的边，取完最小的边后**更新**于其相关的边的二次误差，这就需要用到**优先队列**

![[1d32a2a84f5b78b74acf7680057d3d0.jpg||500]]